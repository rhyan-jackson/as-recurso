<%= turbo_frame_tag "modal-content" do %>
  <div class="modal-header">
    <h1><%= @station.name %></h1>
    <button data-action="click->modal#close" class="close-button">&times;</button>
  </div>
  <div class="station-details">
    <div class="station-info">
      <h2>Informa√ß√µes da Esta√ß√£o</h2>
      <p><strong>Localiza√ß√£o:</strong> <%= @station.county.name %></p>
      <p><strong>Coordenadas:</strong> <%= @station.latitude %>, <%= @station.longitude %></p>
      <p><strong>Capacidade M√°xima:</strong> <%= @station.max_capacity %> bicicletas</p>
      <p><strong>Bicicletas Dispon√≠veis:</strong> <%= @available_bikes.count %></p>
    </div>

    <% if @reserved_bike %>
      <!-- Show reservation pickup section -->
      <div class="reservation-section">
        <h2>üéØ Tem uma Reserva Ativa</h2>
        <div class="reservation-card">
          <div class="reservation-details">
            <h3><%= @reserved_bike.brand %></h3>
            <p><strong>Reserva v√°lida at√©:</strong> <%= @reservation.end_time.strftime("%H:%M") %></p>
            <p><strong>Pre√ßo da reserva:</strong> <%= @reservation.price %>‚Ç¨</p>
          </div>
          <div class="reservation-actions">
            <%= button_to "Levantar Reserva", 
                pickup_reservation_path(@reservation),
                method: :patch,
                class: "btn btn-primary btn-large",
                data: { turbo_frame: "_top" } %>
            <%= button_to "Cancelar Reserva", 
                cancel_reservation_path(@reservation),
                method: :patch,
                class: "btn btn-secondary",
                confirm: "Tem a certeza que quer cancelar esta reserva?",
                data: { turbo_frame: "_top" } %>
          </div>
        </div>
      </div>
    <% elsif @bike_types.any? %>
      <!-- Show regular bike rental section -->
      <div class="bike-types-section">
        <h2>Tipos de Bicicletas Dispon√≠veis</h2>
        
        <div class="bike-types-grid">
          <% @bike_types.each do |bike_type| %>
            <div class="bike-type-card">
              <div class="bike-type-header">
                <h3><%= bike_type[:brand] %></h3>
                <span class="availability-badge">
                  <%= bike_type[:count] %> dispon√≠ve<%= bike_type[:count] > 1 ? 'is' : 'l' %>
                </span>
              </div>
              
              <div class="bike-type-details">
                <p><strong>Pre√ßo:</strong> <%= bike_type[:price] %>‚Ç¨/hora</p>
                <p><strong>Estado:</strong> 
                  <span class="status-badge status-available">Dispon√≠vel</span>
                </p>
              </div>
              
              <div class="bike-type-actions">
                <%= link_to "Alugar #{bike_type[:brand]}", 
                    stations_path(mode: 'select_destination', origin: @station.id, brand: bike_type[:brand]),
                    class: "btn btn-success",
                    data: { action: "click->modal#close" } %>
                <%= link_to "Reservar", 
                    new_station_reservation_path(@station, brand: bike_type[:brand]), 
                    class: "btn btn-warning" %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="no-bikes">
        <h2>Sem Bicicletas Dispon√≠veis</h2>
        <p>N√£o h√° bicicletas dispon√≠veis nesta esta√ß√£o no momento.</p>
        <p>Tente noutra esta√ß√£o ou volte mais tarde.</p>
      </div>
    <% end %>
  </div>
<% end %>